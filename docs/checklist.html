

<!doctype html>

<html
  lang="en"
  class="layout-menu-fixed layout-compact"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free">
  <head>
    <script>
  // Kullanıcı giriş kontrolü
  (function() {
    const ad = localStorage.getItem("displayName");
    if (!ad) {
      // Giriş yapılmamışsa login sayfasına yönlendir
      window.location.href = "login.html";
    }
  })();
</script>

    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

    <title>CGV Mars | Checklist Portal</title>

    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/img/favicon/favicon.ico" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet" />

    <link rel="stylesheet" href="../assets/vendor/fonts/iconify-icons.css" />

    <!-- Core CSS -->
    <!-- build:css assets/vendor/css/theme.css  -->

    <link rel="stylesheet" href="../assets/vendor/css/core.css" />
    <link rel="stylesheet" href="../assets/css/demo.css" />

    <!-- Vendors CSS -->

    <link rel="stylesheet" href="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />

    <!-- endbuild -->

    <link rel="stylesheet" href="../assets/vendor/libs/apex-charts/apex-charts.css" />

    <!-- Page CSS -->

    <!-- Helpers -->
    <script src="../assets/vendor/js/helpers.js"></script>
    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->

    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->

    <script src="../assets/js/config.js"></script>
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->

        <!-- Sidebar Menü -->
<aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
  <div class="app-brand demo">
    <a href="index.html" class="app-brand-link">
      <span class="app-brand-text  menu-text fw-bolder ms-2">CGV Mars | Checklist Portal</span>
    </a>
  </div>

  <div class="menu-inner-shadow"></div>

<ul class="menu-inner py-1">
  <!-- Dashboard -->
  <li class="menu-item">
    <a href="index.html" class="menu-link">
      <i class="menu-icon tf-icons bx bx-home"></i>
      <div>Dashboard</div>
    </a>
  </li>
<!-- Checklist -->
<li class="menu-item open active">
  <a href="javascript:void(0);" class="menu-link menu-toggle">
    <i class="menu-icon tf-icons bx bx-check-square"></i>
    <div>Checklistler</div>
  </a>
  <ul class="menu-sub">
    <li class="menu-item active">
      <a href="checklist.html" class="menu-link">
        <div>Checklist Ana Sayfa</div>
      </a>
    </li>
    <li class="menu-item">
      <a href="checklist-kst.html" class="menu-link">
        <div>KST Checklist</div>
      </a>
    </li>
  </ul>
</li>


</ul>
</aside>

        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

          <nav
            class="layout-navbar container-xxl navbar-detached navbar navbar-expand-xl align-items-center bg-navbar-theme"
            id="layout-navbar">
            <div class="layout-menu-toggle navbar-nav align-items-xl-center me-4 me-xl-0 d-xl-none">
              <a class="nav-item nav-link px-0 me-xl-6" href="javascript:void(0)">
                <i class="icon-base bx bx-menu icon-md"></i>
              </a>
            </div>

            <div class="navbar-nav-right d-flex align-items-center justify-content-end" id="navbar-collapse">
              <!-- Search -->
              <div class="navbar-nav align-items-center me-auto">
                <div class="nav-item d-flex align-items-center">
                  <span class="w-px-22 h-px-22"><i class="icon-base bx bx-search icon-md"></i></span>
                  <input
                    type="text"
                    class="form-control border-0 shadow-none ps-1 ps-sm-2 d-md-block d-none"
                    placeholder="Ara..."
                    aria-label="Ara..." />
                </div>
              </div>
              <!-- /Search -->

              <ul class="navbar-nav flex-row align-items-center ms-md-auto">
                <!-- Place this tag where you want the button to render. -->


                <!-- User -->
                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                  <a
                    class="nav-link dropdown-toggle hide-arrow p-0"
                    href="javascript:void(0);"
                    data-bs-toggle="dropdown">
                    <div class="avatar avatar-online">
                      <img src="../assets/img/avatars/1.png" alt class="w-px-40 h-auto rounded-circle" />
                    </div>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <a class="dropdown-item" href="#">
                        <div class="d-flex">
                          <div class="flex-shrink-0 me-3">
                            <div class="avatar avatar-online">
                              <img src="../assets/img/avatars/1.png" alt class="w-px-40 h-auto rounded-circle" />
                            </div>
                          </div>
                          <div class="flex-grow-1">
                            <h6 class="mb-0">Optimum Gaziemir</h6>
                             
                          </div>
                        </div>
                      </a>
                    </li>
                    <li>
                      <div class="dropdown-divider my-1"></div>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#">
                        <i class="icon-base bx bx-user icon-md me-3"></i><span> Profil</span>
                      </a>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#">
                        <i class="icon-base bx bx-cog icon-md me-3"></i><span>Ayarlar</span>
                      </a>
                    </li>
 
                    <li>
                      <div class="dropdown-divider my-1"></div>
                    </li>
                      <li>
                        <a class="dropdown-item" href="javascript:void(0);" onclick="logout()">
                          <i class="icon-base bx bx-power-off icon-md me-3"></i><span>Çıkış Yap</span>
                        </a>
                      </li>

                      <script>
                        function logout() {
                          localStorage.removeItem("displayName");
                          window.location.href = "login.html";
                        }
                      </script>
                <!--/ User -->
              </ul>
            </div>
          </nav>

          <!-- / Navbar -->
   <!-- Content wrapper -->


<div class="container-xxl flex-grow-1 container-p-y">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="fw-bold mb-0">Aktif Checklistler</h4>
    <a href="checklist-records.html" class="btn btn-outline-primary">
      <i class="bx bx-history me-1"></i> Geçmiş KST Checklistleri
    </a>
  </div>

  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>Checklist</th>
              <th>Tarih</th>
              <th>Açılış</th>
              <th>Kapanış</th>
              <th>Durum</th>
              <th class="text-center">İşlem</th>
            </tr>
          </thead>
          <tbody id="checklistTable"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>






          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->


    <!-- Core JS -->

    <script src="../assets/vendor/libs/jquery/jquery.js"></script>

    <script src="../assets/vendor/libs/popper/popper.js"></script>
    <script src="../assets/vendor/js/bootstrap.js"></script>

    <script src="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="../assets/vendor/js/menu.js"></script>

    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="../assets/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->

    <script src="../assets/js/main.js"></script>

    <!-- Page JS -->
    <script src="../assets/js/dashboards-analytics.js"></script>

    <!-- Place this tag before closing body tag for github widget button. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  <
<script>

(function(){
  "use strict";
  var STORAGE_KEY="checklistKayitlar";
  var FORM_URL="docs/checklist-kst.html";
  var tbId="checklistTable";
  function read(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]"); }catch(e){ return []; } }
  function byDateDesc(a,b){
    // expect YYYY-MM-DD; fallback to string compare
    var da = Date.parse(a.tarih||"") || 0;
    var db = Date.parse(b.tarih||"") || 0;
    return db - da;
  }
  function esc(s){ return String(s==null?"":s).replace(/[&<>]/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[m])); }
  function render(){
    var tbody = document.getElementById(tbId);
    if(!tbody) return;
    var rows = read().slice().sort(byDateDesc);
    if(rows.length===0){
      tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted py-4">Kayıt bulunamadı.</td></tr>';
      return;
    }
    tbody.innerHTML = rows.map(function(k){
      var durum = k.kapanisTamam ? "Tamamlandı" : (k.acilisTamam ? "Kapanış Bekliyor" : "Açılış Bekliyor");
      var badge = k.kapanisTamam ? "bg-success" : (k.acilisTamam ? "bg-warning" : "bg-secondary");
      var btnLabel = k.kapanisTamam ? "" : (k.acilisTamam ? "Devam Et" : "Aç");
      var mode = k.kapanisTamam ? "" : (k.acilisTamam ? "resume" : "open");
      var btn = k.kapanisTamam
        ? '<button class="btn btn-outline-secondary btn-sm" disabled>Tamamlandı</button>'
        : '<button class="btn btn-primary btn-sm" data-mode="'+mode+'" data-tarih="'+esc(k.tarih||"")+'">'+btnLabel+'</button>';
      return '<tr>'
        + '<td>KST</td>'
        + '<td>'+esc(k.tarih || "-")+'</td>'
        + '<td>'+esc(k.acilisSorumlu || "-")+'</td>'
        + '<td>'+esc(k.kapanisSorumlusu || "-")+'</td>'
        + '<td><span class="badge '+badge+'">'+durum+'</span></td>'
        + '<td class="text-center">'+btn+'</td>'
        + '</tr>';
    }).join("");

    Array.prototype.forEach.call(tbody.querySelectorAll("button.btn-primary"), function(btn){
      btn.addEventListener("click", function(){
        var t = btn.getAttribute("data-tarih");
        var mode = btn.getAttribute("data-mode"); // "open" or "resume"
        if(!t) return;
        // Only set resume flags when continuing to Kapanış
        if(mode==="resume"){
          try{
            var data = read();
            for(var i=0;i<data.length;i++){
              if(data[i].tarih===t){
                data[i].kapanisAktif = true;
                break;
              }
            }
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            localStorage.setItem("devam_"+t, "1"); // also drop a one-shot resume flag for form page
          }catch(e){}
        }
        var url = new URL(FORM_URL, location.origin);
        url.searchParams.set("tarih", t);
        if(mode==="resume") url.searchParams.set("resume","1");
        location.href = url.toString();
      });
    });
  }
  document.addEventListener("DOMContentLoaded", render);
})();

</script>
/body>
</html>





